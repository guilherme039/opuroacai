# 🗺️ Diagrama de Fluxo - Sistema de Pedidos

## 📊 Fluxo Completo do Sistema

```
┌─────────────────────────────────────────────────────────────────────┐
│                         CLIENTE ACESSA SITE                          │
│                         (index_test.html)                            │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      NAVEGA NO CARDÁPIO                              │
│  • Visualiza produtos disponíveis                                    │
│  • Vê preços e descrições                                            │
│  • Seleciona tamanhos                                                │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    PERSONALIZA PRODUTO                               │
│  • Escolhe frutas                                                    │
│  • Seleciona complementos                                            │
│  • Adiciona coberturas                                               │
│  • Inclui adicionais                                                 │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    ADICIONA AO CARRINHO                              │
│  • Item formatado e salvo                                            │
│  • Preço calculado                                                   │
│  • Exibido no carrinho                                               │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                    ┌────────────┴────────────┐
                    │  Adicionar mais itens?  │
                    └────────────┬────────────┘
                                 │ Não
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                   PREENCHE DADOS PESSOAIS                            │
│  • Nome completo                                                     │
│  • Telefone (WhatsApp)                                               │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                   ESCOLHE TIPO DE ENTREGA                            │
│                                                                       │
│  ┌──────────────┐                    ┌──────────────┐               │
│  │   DELIVERY   │                    │   RETIRADA   │               │
│  └──────┬───────┘                    └──────┬───────┘               │
│         │                                    │                       │
│         ▼                                    ▼                       │
│  • Seleciona bairro                   • Sem taxa                    │
│  • Preenche endereço                  • Retirar no local            │
│  • Taxa calculada                                                    │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                  SELECIONA FORMA DE PAGAMENTO                        │
│                                                                       │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                          │
│  │   PIX    │  │ DINHEIRO │  │  CARTÃO  │                          │
│  │ 2% desc. │  │  Troco   │  │ Na entr. │                          │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘                          │
└───────┼─────────────┼─────────────┼────────────────────────────────┘
        │             │             │
        ▼             ▼             ▼
┌───────────┐  ┌───────────┐  ┌───────────┐
│ Gera QR   │  │ Informa   │  │ Confirma  │
│ Code PIX  │  │ valor p/  │  │ pagamento │
│           │  │ troco     │  │ na entr.  │
└─────┬─────┘  └─────┬─────┘  └─────┬─────┘
      │              │              │
      └──────────────┴──────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    CONFIRMAÇÃO DE PAGAMENTO                          │
│  • Valida dados                                                      │
│  • Calcula total final                                               │
│  • Exibe resumo                                                      │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    SALVA PEDIDO NO SISTEMA                           │
│  saveOrderToSystem(orderData)                                        │
│                                                                       │
│  1. Gera ID único                                                    │
│  2. Obtém número do pedido (001, 002, ...)                          │
│  3. Formata itens do carrinho                                        │
│  4. Calcula valores finais                                           │
│  5. Cria objeto do pedido                                            │
│  6. Salva em localStorage ('acai_orders')                            │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    APLICA CASHBACK (5%)                              │
│  applyWalletCashback()                                               │
│                                                                       │
│  • Calcula 5% do total                                               │
│  • Adiciona ao saldo da carteira                                     │
│  • Registra transação                                                │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    LIMPA CARRINHO                                    │
│  • Remove todos os itens                                             │
│  • Reseta valores                                                    │
│  • Atualiza interface                                                │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    EXIBE CONFIRMAÇÃO                                 │
│  • Número do pedido                                                  │
│  • Link para acompanhamento                                          │
│  • Mensagem de sucesso                                               │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    CLIENTE ACOMPANHA PEDIDO                          │
│                    (acompanhamento.html)                             │
│                                                                       │
│  • Digita número do pedido                                           │
│  • Visualiza status atual                                            │
│  • Vê detalhes completos                                             │
│  • Recebe atualizações                                               │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 Fluxo de Status do Pedido

```
┌──────────────┐
│   PENDING    │  ⏳ Pedido Recebido
│  (inicial)   │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│  PREPARING   │  👨‍🍳 Em Preparo
│              │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│    READY     │  ✅ Pronto
│              │
└──────┬───────┘
       │
       ├─────────────────┐
       │                 │
       ▼                 ▼
┌──────────────┐  ┌──────────────┐
│OUT_FOR_DELIV.│  │   PICKUP     │
│  🛵 Saiu     │  │  🏪 Retirar  │
└──────┬───────┘  └──────┬───────┘
       │                 │
       └────────┬────────┘
                │
                ▼
         ┌──────────────┐
         │  DELIVERED   │  🎉 Entregue/Retirado
         │   (final)    │
         └──────────────┘

         ┌──────────────┐
         │  CANCELLED   │  ❌ Cancelado (qualquer momento)
         └──────────────┘
```

---

## 💾 Fluxo de Dados no LocalStorage

```
┌─────────────────────────────────────────────────────────────────────┐
│                         LOCALSTORAGE                                 │
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ acai_orders (Array)                                         │    │
│  │ ┌────────────────────────────────────────────────────────┐ │    │
│  │ │ { id: 'order_...', orderNumber: '001', ... }           │ │    │
│  │ │ { id: 'order_...', orderNumber: '002', ... }           │ │    │
│  │ │ { id: 'order_...', orderNumber: '003', ... }           │ │    │
│  │ └────────────────────────────────────────────────────────┘ │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                       │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ orders_Sat Nov 29 2025 (Object)                            │    │
│  │ { count: 15, date: 'Sat Nov 29 2025' }                     │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                       │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ acai_wallets (Array)                                        │    │
│  │ ┌────────────────────────────────────────────────────────┐ │    │
│  │ │ { phone: '(11) 99999-9999', balance: 15.75, ... }      │ │    │
│  │ │ { phone: '(11) 98888-8888', balance: 8.50, ... }       │ │    │
│  │ └────────────────────────────────────────────────────────┘ │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                       │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ acai_menu (Object)                                          │    │
│  │ { products: [...], prices: {...}, ... }                    │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                       │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ acai_neighborhoods (Array)                                  │    │
│  │ [{ name: 'Centro', fee: 5.00 }, ...]                       │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                       │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 💰 Fluxo de Cálculos Financeiros

```
┌─────────────────────────────────────────────────────────────────────┐
│                      CÁLCULO DO TOTAL                                │
└─────────────────────────────────────────────────────────────────────┘

    ┌──────────────────┐
    │   SUBTOTAL       │  Soma de todos os itens do carrinho
    │   R$ 25,00       │
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │ TAXA DE ENTREGA  │  Se delivery: taxa do bairro
    │   + R$ 5,00      │  Se retirada: R$ 0,00
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │ DESCONTO PIX     │  Se PIX: 2% do subtotal
    │   - R$ 0,50      │  Outros: R$ 0,00
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │  TOTAL FINAL     │  Subtotal + Taxa - Desconto
    │   R$ 29,50       │
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │   CASHBACK       │  5% do total final
    │   R$ 1,48        │  Creditado na carteira
    └──────────────────┘
```

---

## 🔗 Fluxo de Integração entre Sistemas

```
┌─────────────────────────────────────────────────────────────────────┐
│                    SISTEMA PRINCIPAL (script.js)                     │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                    ┌────────────┼────────────┐
                    │            │            │
                    ▼            ▼            ▼
        ┌───────────────┐  ┌──────────┐  ┌──────────┐
        │   CARTEIRA    │  │   PIX    │  │  ADMIN   │
        │ (wallet-int.) │  │(pix-pay.)│  │(admin.js)│
        └───────┬───────┘  └────┬─────┘  └────┬─────┘
                │               │             │
                │               │             │
                ▼               ▼             ▼
        ┌───────────────────────────────────────┐
        │         LOCALSTORAGE                  │
        │  • acai_orders                        │
        │  • acai_wallets                       │
        │  • orders_${date}                     │
        └───────────────┬───────────────────────┘
                        │
                        ▼
        ┌───────────────────────────────────────┐
        │      ACOMPANHAMENTO                   │
        │      (acompanhamento.js)              │
        └───────────────────────────────────────┘
```

---

## 📱 Fluxo de Páginas do Sistema

```
┌─────────────────────────────────────────────────────────────────────┐
│                         PÁGINAS DO SISTEMA                           │
└─────────────────────────────────────────────────────────────────────┘

    ┌──────────────────┐
    │ index_test.html  │  🏠 Página Principal
    │                  │  • Cardápio
    │                  │  • Carrinho
    │                  │  • Checkout
    └────────┬─────────┘
             │
             ├─────────────────────────────────────┐
             │                                     │
             ▼                                     ▼
    ┌──────────────────┐                 ┌──────────────────┐
    │acompanhamento.   │                 │  carteira.html   │
    │     html         │  📍 Acompanhar  │                  │  💰 Carteira
    │                  │     Pedido      │                  │     Digital
    └──────────────────┘                 └──────────────────┘

             │
             ├─────────────────────────────────────┐
             │                                     │
             ▼                                     ▼
    ┌──────────────────┐                 ┌──────────────────┐
    │   admin.html     │                 │ controle.html    │
    │                  │  🔧 Painel      │                  │  ⚙️ Controle
    │                  │     Admin       │                  │    Cardápio
    └──────────────────┘                 └──────────────────┘
```

---

## 🎯 Fluxo de Decisão do Cliente

```
                    ┌─────────────────┐
                    │ Cliente no Site │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │ Tem cadastro?   │
                    └────┬───────┬────┘
                         │       │
                    Não  │       │  Sim
                         │       │
                         ▼       ▼
                    ┌────────┐  ┌────────┐
                    │Cadastra│  │ Login  │
                    │ dados  │  │automát.│
                    └────┬───┘  └───┬────┘
                         │          │
                         └────┬─────┘
                              │
                    ┌─────────▼─────────┐
                    │ Escolhe produtos  │
                    └─────────┬─────────┘
                              │
                    ┌─────────▼─────────┐
                    │ Tipo de entrega?  │
                    └────┬───────┬──────┘
                         │       │
                  Delivery│       │Retirada
                         │       │
                         ▼       ▼
                    ┌────────┐  ┌────────┐
                    │Endereço│  │ Horário│
                    │+ Taxa  │  │retirada│
                    └────┬───┘  └───┬────┘
                         │          │
                         └────┬─────┘
                              │
                    ┌─────────▼─────────┐
                    │ Forma pagamento?  │
                    └─┬─────┬─────┬─────┘
                      │     │     │
                  PIX │     │Dinh.│Card
                      │     │     │
                      ▼     ▼     ▼
                    ┌────────────────┐
                    │ Confirma pedido│
                    └────────┬───────┘
                             │
                    ┌────────▼────────┐
                    │ Recebe número   │
                    │ Acompanha status│
                    └─────────────────┘
```

---

## 🔄 Ciclo de Vida do Pedido

```
┌─────────────────────────────────────────────────────────────────────┐
│                    CICLO DE VIDA DO PEDIDO                           │
└─────────────────────────────────────────────────────────────────────┘

    CRIAÇÃO                PROCESSAMENTO              FINALIZAÇÃO
       │                        │                          │
       ▼                        ▼                          ▼
    
    ⏳ Pending          👨‍🍳 Preparing              ✅ Ready
    (0-2 min)           (10-20 min)               (pronto)
       │                        │                          │
       │                        │                          │
       ▼                        ▼                          ▼
    
    • Cliente faz       • Loja prepara            • Delivery: 🛵
      pedido             o pedido                   Saiu p/ entrega
    • Sistema salva     • Atualiza status         
    • Gera número       • Notifica cliente        • Retirada: 🏪
    • Aplica cashback                               Cliente retira
                                                          │
                                                          ▼
                                                    
                                                    🎉 Delivered
                                                    (concluído)

    ❌ Cancelled (pode ocorrer em qualquer momento)
```

---

## 📊 Fluxo de Dados - Visão Técnica

```
┌─────────────────────────────────────────────────────────────────────┐
│                      ARQUITETURA DE DADOS                            │
└─────────────────────────────────────────────────────────────────────┘

    FRONTEND (HTML/JS)              STORAGE              BACKEND (Futuro)
    
    ┌──────────────┐              ┌──────────┐          ┌──────────┐
    │ index_test   │──────────────│LocalStor.│          │   API    │
    │   .html      │   write      │          │          │          │
    └──────┬───────┘              │ • orders │          │ • POST   │
           │                      │ • wallets│          │ • GET    │
           │                      │ • menu   │          │ • PUT    │
    ┌──────▼───────┐              │ • config │          │ • DELETE │
    │  script.js   │──────────────│          │          │          │
    │              │   read       └────┬─────┘          └────┬─────┘
    └──────┬───────┘                   │                     │
           │                           │                     │
    ┌──────▼───────┐                   │                     │
    │wallet-int.js │───────────────────┘                     │
    └──────┬───────┘                                         │
           │                                                 │
    ┌──────▼───────┐                                         │
    │acompanhamen. │                                         │
    │   to.js      │─────────────────────────────────────────┘
    └──────────────┘              (sincronização futura)
```

---

**Este diagrama fornece uma visão visual completa do sistema!**

---

**Última atualização:** 29/11/2025  
**Versão:** 1.0
